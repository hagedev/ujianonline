<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tes Karyawan - BPR Indra Arta</title>
    <!-- 1. Muat Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style untuk tombol pilihan kuis */
        .option-btn {
            transition: all 0.2s ease-in-out;
        }
        .option-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .option-btn.correct {
            border-color: #22c55e;
            background-color: #f0fdf4;
            color: #166534;
        }
        .option-btn.wrong {
            border-color: #ef4444;
            background-color: #fef2f2;
            color: #991b1b;
        }
        .option-btn:disabled {
            opacity: 0.8;
            cursor: not-allowed;
        }
        /* Simple spinner for start button */
        .spinner {
            border: 2px solid rgba(255,255,255,0.3);
            border-left-color: #fff;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">

    <!-- Kontainer Aplikasi Utama -->
    <div id="app-container" class="w-full">

        <!-- ============================================= -->
        <!-- BAGIAN APLIKASI KUIS (PESERTA)                -->
        <!-- ============================================= -->
        <div id="quiz-app" class="flex items-center justify-center min-h-screen p-4">
            <div id="app" class="w-full max-w-2xl bg-white rounded-xl shadow-2xl overflow-hidden">
                
                <!-- Header Aplikasi -->
                <div class="p-6 bg-gradient-to-r from-blue-600 to-blue-800 text-white text-center">
                    <h1 class="text-2xl font-bold">Tes Penerimaan Karyawan</h1>
                    <p class="text-lg opacity-90">BPR Indra Arta</p>
                </div>

                <!-- 1. Layar Mulai (Start Screen) -->
                <div id="start-screen" class="p-8 space-y-6">
                    <h2 class="text-xl font-semibold text-gray-800">Selamat Datang, Calon Karyawan!</h2>
                    <p class="text-gray-600">Tes ini terdiri dari 10 pertanyaan pilihan ganda. Setiap soal memiliki waktu 3 menit. Jika waktu habis, jawaban dianggap salah. Kerjakanlah dengan jujur dan teliti.</p>
                    
                    <div class="space-y-4">
                        <div>
                            <label for="name-input" class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap Anda</label>
                            <input type="text" id="name-input" placeholder="Masukkan nama lengkap Anda..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <p id="name-error" class="text-red-500 text-sm mt-1 hidden">Nama tidak boleh kosong.</p>
                        </div>
                    </div>
                    
                    <button id="start-btn" class="w-full bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-lg hover:bg-blue-700 transition duration-300 flex items-center justify-center space-x-2 disabled:opacity-75">
                        <span id="start-btn-text">Mulai Tes</span>
                        <div id="start-spinner" class="spinner hidden"></div>
                    </button>
                    <p id="load-error" class="text-red-500 text-sm text-center mt-2 hidden">Gagal memuat soal. Coba muat ulang halaman.</p>

                    <div class="text-center pt-2">
                        <!-- Link Admin di-bind dengan JavaScript -->
                        <a href="#" id="admin-login-link" class="text-sm text-blue-600 hover:underline">
                            Login sebagai Admin
                        </a>
                    </div>
                </div>

                <!-- 2. Layar Kuis (Quiz Screen) -->
                <div id="quiz-screen" class="p-8 hidden">
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-medium text-blue-700">Pertanyaan</span>
                            <span id="question-counter" class="text-sm font-medium text-gray-500">1 / 10</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 10%"></div>
                        </div>
                    </div>
                    <h2 id="question-text" class="text-xl font-semibold text-gray-800 mb-6" style="min-height: 50px;">...</h2>
                    <div class="flex justify-center mb-6">
                        <span id="timer-display" class="text-xl font-bold text-red-600 font-mono bg-red-50 border-2 border-red-200 rounded-lg px-6 py-2 shadow-inner">
                            Sisa Waktu: 3:00
                        </span>
                    </div>
                    <div id="options-container" class="space-y-3 mb-8"></div>
                    <div class="flex justify-end">
                        <button id="next-btn" class="bg-gray-400 text-white font-semibold py-2 px-8 rounded-lg transition duration-300 cursor-not-allowed" disabled>
                            Lanjut
                        </button>
                    </div>
                </div>

                <!-- 3. Layar Hasil (Result Screen) -->
                <div id="result-screen" class="p-8 text-center hidden space-y-6">
                    <h2 class="text-2xl font-bold text-gray-800">Tes Selesai!</h2>
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg text-left">
                        <p class="text-gray-700">Terima kasih, <strong id="result-name"></strong>, telah menyelesaikan tes.</p>
                        <p class="text-lg text-gray-800 mt-2">Skor Anda:</p>
                        <p id="score-text" class="text-5xl font-extrabold text-blue-600 my-2">100</p>
                        <p id="score-detail" class="text-gray-600">Anda menjawab 10 dari 10 soal dengan benar.</p>
                    </div>
                    <div class="py-4 space-y-3">
                        <div id="loading-spinner" class="flex justify-center items-center space-x-2">
                            <svg class="animate-spin h-5 w-5 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            <span class="text-gray-600 font-medium">Menyimpan hasil Anda...</span>
                        </div>
                        <p id="result-text" class="text-lg font-semibold hidden"></p>
                    </div>
                    <p class="text-gray-500 text-sm max-w-md mx-auto">Anda bisa menutup halaman ini.</p>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- BAGIAN ADMIN LOGIN (BARU)                     -->
        <!-- ============================================= -->
        <div id="admin-login-screen" class="min-h-screen hidden flex items-center justify-center p-4">
            <div class="w-full max-w-sm bg-white rounded-xl shadow-2xl p-8 space-y-6">
                <h2 class="text-2xl font-bold text-center text-gray-800">Login Admin</h2>
                <div>
                    <label for="password-input" class="block text-sm font-medium text-gray-700">Password</label>
                    <input type="password" id="password-input" class="w-full mt-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <p id="password-error" class="text-red-500 text-sm mt-2 hidden">Password salah. Silakan coba lagi.</p>
                </div>
                <button id="login-btn" class="w-full bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg shadow-lg hover:bg-blue-700 transition duration-300">
                    Masuk
                </button>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- BAGIAN ADMIN (DASBOR)                         -->
        <!-- ============================================= -->
        <div id="admin-app" class="min-h-screen hidden">
            <div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 shadow-md">
                <h1 class="text-3xl font-bold container mx-auto max-w-5xl">Dasbor Hasil Tes Karyawan</h1>
                <p class="container mx-auto max-w-5xl opacity-90">BPR Indra Arta</p>
            </div>

            <div class="container mx-auto max-w-5xl p-6">
                <div id="loading-status" class="text-center p-10 bg-white rounded-lg shadow">
                    <p class="text-lg font-medium text-gray-600">Menghubungkan ke database...</p>
                </div>
                <div id="results-list" class="hidden space-y-4">
                    <div class="hidden md:grid grid-cols-4 gap-4 font-semibold text-gray-600 bg-gray-50 p-4 rounded-lg">
                        <div>Nama Peserta</div>
                        <div>Skor</div>
                        <div>Detail Jawaban</div>
                        <div>Waktu Pengerjaan</div>
                    </div>
                    <div id="results-content"></div>
                    <div id="empty-message" class="hidden text-center p-10 bg-white rounded-lg shadow">
                        <p class="text-lg text-gray-500">Belum ada hasil tes yang masuk.</p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Script akan diubah menjadi module untuk Firebase -->
    <script type="module">
        // --- 0. IMPORT FIREBASE ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, serverTimestamp, setLogLevel, onSnapshot, query } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- Inisialisasi Firebase ---
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        // Gunakan AppID dinamis agar admin & kuis berada di 'folder' yg sama
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-quiz-app'; 
        
        let db, auth, userId;
        
        try {
            const app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            setLogLevel('Debug'); 

            if (typeof __initial_auth_token !== 'undefined') {
                await signInWithCustomToken(auth, __initial_auth_token);
            } else {
                await signInAnonymously(auth);
            }
            userId = auth.currentUser?.uid || crypto.randomUUID();
            console.log("Firebase auth successful, UserID:", userId);
            console.log("Using AppID:", appId);
        } catch (error) {
            console.error("Firebase auth failed:", error);
            userId = crypto.randomUUID();
        }

        // --- Variabel Global Kuis ---
        let questions = []; // Akan diisi dari soal.json
        let currentQuestionIndex = 0;
        let score = 0;
        let userName = "";
        let selectedAnswer = null;
        let timerInterval;
        let remainingTime;


        // --- Cek Mode Admin ---
        const urlParams = new URLSearchParams(window.location.search);
        let isAdminMode = urlParams.get('admin') === 'true'; // Kita gunakan let

        const quizApp = document.getElementById('quiz-app');
        const adminApp = document.getElementById('admin-app');
        const adminLoginScreen = document.getElementById('admin-login-screen');
        const passwordInput = document.getElementById('password-input');
        const loginBtn = document.getElementById('login-btn');
        const passwordError = document.getElementById('password-error');
        const adminLoginLink = document.getElementById('admin-login-link');


        // Fungsi untuk menampilkan layar yang benar
        function showCorrectScreen() {
            if (isAdminMode) {
                // Tampilkan Admin Login, Sembunyikan Kuis
                quizApp.classList.add('hidden');
                adminLoginScreen.classList.remove('hidden'); 
                adminLoginScreen.classList.add('flex'); 
                adminApp.classList.add('hidden'); 
            } else {
                // Tampilkan Kuis, Sembunyikan Admin & Admin Login
                quizApp.classList.remove('hidden');
                adminApp.classList.add('hidden');
                adminLoginScreen.classList.add('hidden');
            }
        }
        
        // Panggil fungsi ini saat halaman dimuat
        showCorrectScreen();

        // ==========================================
        // KODE UNTUK ADMIN
        // ==========================================
        
        // Referensi DOM Admin
        const loadingStatus = document.getElementById('loading-status');
        const resultsList = document.getElementById('results-list');
        const resultsContent = document.getElementById('results-content');
        const emptyMessage = document.getElementById('empty-message');

        function initializeAdmin() {
            console.log("Admin mode initialized. Listening for results...");
            listenToResults();
        }

        function listenToResults() {
            if (!db) {
                loadingStatus.textContent = "Database tidak terinisialisasi.";
                return;
            }
            // Path koleksi HARUS SAMA PERSIS dengan saat menyimpan
            const resultsCollection = collection(db, 'artifacts', appId, 'public', 'data', 'quiz_results');
            
            // Buat query untuk mengurutkan (jika diperlukan, tapi kita urutkan di client)
            const q = query(resultsCollection);

            onSnapshot(q, (snapshot) => {
                loadingStatus.classList.add('hidden');
                resultsList.classList.remove('hidden');
                
                let results = [];
                snapshot.forEach(doc => results.push(doc.data()));

                if (results.length === 0) {
                    emptyMessage.classList.remove('hidden');
                    resultsContent.innerHTML = '';
                    return;
                }

                emptyMessage.classList.add('hidden');
                // Urutkan berdasarkan timestamp, dari yang terbaru
                results.sort((a, b) => (b.timestamp?.toMillis() || 0) - (a.timestamp?.toMillis() || 0));
                renderResults(results);

            }, (error) => {
                console.error("Error listening to results:", error);
                loadingStatus.classList.remove('hidden');
                loadingStatus.textContent = `Gagal mengambil data: ${error.message}`;
                loadingStatus.classList.add('text-red-600');
                resultsList.classList.add('hidden');
            });
        }

        function renderResults(results) {
            resultsContent.innerHTML = '';
            results.forEach(res => {
                const name = res.name || 'Tanpa Nama';
                const score = res.score !== undefined ? res.score.toFixed(0) : 'N/A';
                const detail = `${res.correctAnswers || 0} / ${res.totalQuestions || 0} benar`;
                let timestamp = 'N/A';
                if (res.timestamp) {
                    timestamp = res.timestamp.toDate().toLocaleString('id-ID', {
                        day: 'numeric', month: 'short', year: 'numeric',
                        hour: '2-digit', minute: '2-digit'
                    });
                }
                
                const resultCard = `
                    <div class="bg-white p-4 rounded-lg shadow grid grid-cols-1 md:grid-cols-4 gap-2 items-center mb-3">
                        <div class="font-semibold text-gray-800"><span class="md:hidden text-gray-500 font-medium">Nama: </span>${escapeHTML(name)}</div>
                        <div class="text-lg"><span class="md:hidden text-gray-500 font-medium">Skor: </span><span class="font-bold text-blue-600">${score}</span></div>
                        <div class="text-sm text-gray-600"><span class="md:hidden text-gray-500 font-medium">Detail: </span>${escapeHTML(detail)}</div>
                        <div class="text-sm text-gray-500"><span class="md:hidden text-gray-500 font-medium">Waktu: </span>${escapeHTML(timestamp)}</div>
                    </div>
                `;
                resultsContent.innerHTML += resultCard;
            });
        }

        function escapeHTML(str) {
            if (typeof str !== 'string') return '';
            return str.replace(/[&<>"']/g, m => ({'&': '&amp;','<': '&lt;','>': '&gt;','"': '&quot;',"'": '&#39;'}[m]));
        }

        // ==========================================
        // KODE UNTUK KUIS (PESERTA)
        // ==========================================

        // Referensi DOM Kuis
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');
        const nameInput = document.getElementById('name-input');
        const nameError = document.getElementById('name-error');
        const startBtn = document.getElementById('start-btn');
        const startBtnText = document.getElementById('start-btn-text');
        const startSpinner = document.getElementById('start-spinner');
        const loadError = document.getElementById('load-error');
        const questionCounter = document.getElementById('question-counter');
        const progressBar = document.getElementById('progress-bar');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const nextBtn = document.getElementById('next-btn');
        const timerDisplay = document.getElementById('timer-display');
        const resultName = document.getElementById('result-name');
        const scoreText = document.getElementById('score-text');
        const scoreDetail = document.getElementById('score-detail');
        const resultText = document.getElementById('result-text');
        const loadingSpinner = document.getElementById('loading-spinner');

        // --- FUNGSI BARU: Memuat soal dari JSON ---
        async function loadQuestions() {
            startBtn.disabled = true;
            startSpinner.classList.remove('hidden');
            startBtnText.textContent = 'Memuat Soal...';
            loadError.classList.add('hidden');

            try {
                // Pastikan soal.json ada di folder yg sama dgn index.html
                const response = await fetch('soal.json'); 
                if (!response.ok) {
                    throw new Error(`Gagal memuat: ${response.statusText}`);
                }
                questions = await response.json();
                
                if (questions.length === 0) {
                    throw new Error("File soal kosong.");
                }

                // Soal berhasil dimuat, mulai kuis
                startQuiz();

            } catch (error) {
                console.error("Gagal memuat soal:", error);
                loadError.classList.remove('hidden');
                startBtn.disabled = false;
                startSpinner.classList.add('hidden');
                startBtnText.textContent = 'Mulai Tes';
            }
        }

        function startQuiz() {
            userName = nameInput.value.trim();
            if (userName === "") {
                nameError.classList.remove('hidden');
                // Kembalikan tombol start ke state normal jika nama kosong
                startBtn.disabled = false;
                startSpinner.classList.add('hidden');
                startBtnText.textContent = 'Mulai Tes';
                return;
            }
            nameError.classList.add('hidden');
            startScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            showQuestion();
        }

        function showQuestion() {
            clearInterval(timerInterval);
            selectedAnswer = null;
            optionsContainer.innerHTML = '';
            nextBtn.disabled = true;
            nextBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
            nextBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            timerDisplay.classList.remove('animate-pulse', 'text-gray-400'); 

            const question = questions[currentQuestionIndex];
            questionText.textContent = question.question;
            questionCounter.textContent = `${currentQuestionIndex + 1} / ${questions.length}`;
            progressBar.style.width = `${((currentQuestionIndex + 1) / questions.length) * 100}%`;

            question.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('option-btn', 'w-full', 'p-4', 'border-2', 'border-gray-300', 'rounded-lg', 'text-left', 'font-medium', 'text-gray-700');
                button.onclick = () => selectAnswer(option, button);
                optionsContainer.appendChild(button);
            });

            remainingTime = 180; // 3 menit
            updateTimerDisplay();
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            remainingTime--;
            updateTimerDisplay();
            if (remainingTime <= 0) {
                clearInterval(timerInterval);
                handleTimeUp();
            }
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(remainingTime / 60);
            const seconds = remainingTime % 60;
            timerDisplay.textContent = `Sisa Waktu: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            if (remainingTime <= 10 && remainingTime > 0) {
                timerDisplay.classList.add('animate-pulse');
            }
        }

        function handleTimeUp() {
            selectedAnswer = "WAKTU HABIS";
            Array.from(optionsContainer.children).forEach(btn => {
                btn.disabled = true;
                if (btn.textContent === questions[currentQuestionIndex].answer) {
                    btn.classList.add('correct');
                }
            });
            timerDisplay.textContent = "Waktu Habis!";
            timerDisplay.classList.add('text-gray-400');
            timerDisplay.classList.remove('animate-pulse');
            
            // Tunda ke pertanyaan berikutnya selama 2 detik
            setTimeout(() => {
                nextQuestion(); 
            }, 2000); 
        }

        function selectAnswer(option, button) {
            if (selectedAnswer) return;
            clearInterval(timerInterval);
            timerDisplay.classList.remove('animate-pulse');
            selectedAnswer = option;
            const correct = (option === questions[currentQuestionIndex].answer);

            Array.from(optionsContainer.children).forEach(btn => {
                btn.disabled = true;
                if (!correct && btn.textContent === questions[currentQuestionIndex].answer) {
                    btn.classList.add('correct');
                }
            });

            if (correct) {
                score++;
                button.classList.add('correct');
            } else {
                button.classList.add('wrong');
            }

            nextBtn.disabled = false;
            nextBtn.classList.remove('bg-gray-400', 'cursor-not-allowed');
            nextBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
        }

        function nextQuestion() {
            // Cek jika waktu habis, tidak perlu menekan tombol next
            if (selectedAnswer === "WAKTU HABIS") {
                // do nothing, handleTimeUp already triggered nextQuestion
            } else if (!selectedAnswer) {
                // Jika tombol next ditekan tanpa memilih (seharusnya tidak terjadi, tapi sbg penjaga)
                return;
            }

            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                showResult();
            }
        }

        async function saveResultToFirestore(finalGrade) {
            if (!db) {
                console.error("Firestore DB not initialized. Cannot save score.");
                resultText.textContent = "Gagal terhubung ke database. Coba muat ulang halaman.";
                resultText.classList.remove('hidden', 'text-green-600');
                resultText.classList.add('text-red-600');
                loadingSpinner.classList.add('hidden');
                return;
            }
            try {
                // Path koleksi: /artifacts/{appId}/public/data/quiz_results
                const resultsCollection = collection(db, 'artifacts', appId, 'public', 'data', 'quiz_results');
                
                const resultData = {
                    name: userName,
                    score: finalGrade,
                    correctAnswers: score,
                    totalQuestions: questions.length,
                    timestamp: serverTimestamp()
                };

                await addDoc(resultsCollection, resultData);
                
                console.log("Result saved to Firestore with AppID:", appId);
                loadingSpinner.classList.add('hidden');
                resultText.textContent = "Hasil Anda telah berhasil disimpan secara otomatis. Terima kasih.";
                resultText.classList.remove('hidden');
                resultText.classList.add('text-green-600');
            } catch (error) {
                console.error("Error saving result to Firestore:", error);
                loadingSpinner.classList.add('hidden');
                resultText.textContent = `Terjadi error saat menyimpan nilai: ${error.message}`;
                resultText.classList.remove('hidden');
                resultText.classList.add('text-red-600');
            }
        }

        function showResult() {
            clearInterval(timerInterval);
            quizScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            const finalGrade = (score / questions.length) * 100;
            resultName.textContent = userName;
            scoreText.textContent = `${finalGrade.toFixed(0)}`;
            scoreDetail.textContent = `Anda menjawab ${score} dari ${questions.length} soal dengan benar.`;
            saveResultToFirestore(finalGrade);
        }

        // --- Event Listeners ---

        // Listener untuk Admin Login
        if (isAdminMode) {
            loginBtn.addEventListener('click', () => {
                const password = passwordInput.value;
                if (password === 'indraarta123') {
                    // Password benar
                    passwordError.classList.add('hidden');
                    adminLoginScreen.classList.add('hidden');
                    adminApp.classList.remove('hidden');
                    initializeAdmin(); // Jalankan dasbor admin
                } else {
                    // Password salah
                    passwordError.classList.remove('hidden');
                    passwordInput.value = '';
                    passwordInput.focus();
                }
            });

            // Tambahkan listener untuk tombol "Enter" di input password
            passwordInput.addEventListener('keyup', (event) => {
                if (event.key === 'Enter') {
                    loginBtn.click();
                }
            });
        }

        // Listener untuk Kuis
        if (!isAdminMode) {
            // Ganti listener tombol Start untuk memuat soal dulu
            startBtn.addEventListener('click', () => {
                userName = nameInput.value.trim();
                if (userName === "") {
                    nameError.classList.remove('hidden');
                    return;
                }
                nameError.classList.add('hidden');
                // Panggil fungsi loadQuestions, bukan startQuiz langsung
                loadQuestions(); 
            });
            nextBtn.addEventListener('click', nextQuestion);
        }

        // Listener untuk Link Admin (FIX - Tanpa Reload)
        adminLoginLink.addEventListener('click', (e) => {
            e.preventDefault(); // Hentikan link biasa
            // Sembunyikan Kuis dan Tampilkan Login Admin
            isAdminMode = true; // Set status admin
            quizApp.classList.add('hidden');
            adminLoginScreen.classList.remove('hidden');
            adminLoginScreen.classList.add('flex');
            adminApp.classList.add('hidden');
            // Fokus ke input password
            passwordInput.focus();
        });

    </script>
</body>
</html>
